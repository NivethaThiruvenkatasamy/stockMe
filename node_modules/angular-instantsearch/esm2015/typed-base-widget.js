import { Input } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import { bem, noop } from './utils';
export class TypedBaseWidget {
    constructor(widgetName) {
        this.updateState = (state, isFirstRendering) => {
            if (isFirstRendering) {
                Promise.resolve().then(() => {
                    this.state = state;
                });
            }
            else {
                this.state = state;
            }
        };
        this.cx = bem(widgetName);
    }
    get parent() {
        if (this.parentIndex) {
            return this.parentIndex;
        }
        return this.instantSearchInstance;
    }
    createWidget(connector, options) {
        this.widget = connector(this.updateState, noop)(options);
    }
    ngOnInit() {
        this.parent.addWidgets([this.widget]);
    }
    ngOnDestroy() {
        if (isPlatformBrowser(this.instantSearchInstance.platformId)) {
            this.parent.removeWidgets([this.widget]);
        }
    }
    /**
     * Helper to generate class names for an item
     * @param item element to generate a class name for
     */
    getItemClass(item) {
        const className = this.cx('item');
        if (item.isRefined) {
            return `${className} ${this.cx('item', 'selected')}`;
        }
        return className;
    }
}
TypedBaseWidget.propDecorators = {
    autoHideContainer: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZWQtYmFzZS13aWRnZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdHlwZWQtYmFzZS13aWRnZXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBaUMsTUFBTSxlQUFlLENBQUM7QUFDckUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEQsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFjcEMsTUFBTSxPQUFnQixlQUFlO0lBWW5DLFlBQXNCLFVBQWtCO1FBNEJqQyxnQkFBVyxHQUdkLENBQUMsS0FBSyxFQUFFLGdCQUFnQixFQUFFLEVBQUU7WUFDOUIsSUFBSSxnQkFBZ0IsRUFBRTtnQkFDcEIsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUU7b0JBQzFCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO2dCQUNyQixDQUFDLENBQUMsQ0FBQzthQUNKO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO2FBQ3BCO1FBQ0gsQ0FBQyxDQUFDO1FBdENBLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLE1BQU07UUFDUixJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDcEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO1NBQ3pCO1FBQ0QsT0FBTyxJQUFJLENBQUMscUJBQXFCLENBQUM7SUFDcEMsQ0FBQztJQUVNLFlBQVksQ0FDakIsU0FBMEQsRUFDMUQsT0FBeUI7UUFFekIsSUFBSSxDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFpQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEUsQ0FBQztJQUVNLFFBQVE7UUFDYixJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFTSxXQUFXO1FBQ2hCLElBQUksaUJBQWlCLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQzVELElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7U0FDMUM7SUFDSCxDQUFDO0lBZUQ7OztPQUdHO0lBQ0ksWUFBWSxDQUFDLElBQTZCO1FBQy9DLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFbEMsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2xCLE9BQU8sR0FBRyxTQUFTLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQztTQUN0RDtRQUVELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7OztnQ0E3REEsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgZm9yd2FyZFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgYmVtLCBub29wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBOZ0Fpc0luc3RhbnRTZWFyY2ggfSBmcm9tICcuL2luc3RhbnRzZWFyY2gvaW5zdGFudHNlYXJjaCc7XG5pbXBvcnQgeyBOZ0Fpc0luZGV4IH0gZnJvbSAnLi9pbmRleC13aWRnZXQvaW5kZXgtd2lkZ2V0JztcbmltcG9ydCB7XG4gIFdpZGdldCxcbiAgV2lkZ2V0RGVzY3JpcHRpb24sXG4gIENvbm5lY3RvcixcbiAgVW5tb3VudGVyLFxuICBSZW5kZXJlcixcbiAgVW5rbm93bldpZGdldFBhcmFtcyxcbn0gZnJvbSAnaW5zdGFudHNlYXJjaC5qcy9lcy90eXBlcyc7XG5cbmV4cG9ydCB7IFdpZGdldCwgQ29ubmVjdG9yIH07XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBUeXBlZEJhc2VXaWRnZXQ8XG4gIFRXaWRnZXREZXNjcmlwdGlvbiBleHRlbmRzIFdpZGdldERlc2NyaXB0aW9uLFxuICBUQ29ubmVjdG9yUGFyYW1zIGV4dGVuZHMgVW5rbm93bldpZGdldFBhcmFtc1xuPiBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KCkgcHVibGljIGF1dG9IaWRlQ29udGFpbmVyPzogYm9vbGVhbjtcblxuICBwdWJsaWMgd2lkZ2V0PzogV2lkZ2V0O1xuICBwdWJsaWMgc3RhdGU/OiBUV2lkZ2V0RGVzY3JpcHRpb25bJ3JlbmRlclN0YXRlJ107XG4gIHB1YmxpYyBjeDogUmV0dXJuVHlwZTx0eXBlb2YgYmVtPjtcbiAgcHVibGljIGFic3RyYWN0IGluc3RhbnRTZWFyY2hJbnN0YW5jZTogTmdBaXNJbnN0YW50U2VhcmNoO1xuICBwdWJsaWMgYWJzdHJhY3QgcGFyZW50SW5kZXg/OiBOZ0Fpc0luZGV4O1xuXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3Rvcih3aWRnZXROYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLmN4ID0gYmVtKHdpZGdldE5hbWUpO1xuICB9XG5cbiAgZ2V0IHBhcmVudCgpIHtcbiAgICBpZiAodGhpcy5wYXJlbnRJbmRleCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50SW5kZXg7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmluc3RhbnRTZWFyY2hJbnN0YW5jZTtcbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVXaWRnZXQoXG4gICAgY29ubmVjdG9yOiBDb25uZWN0b3I8VFdpZGdldERlc2NyaXB0aW9uLCBUQ29ubmVjdG9yUGFyYW1zPixcbiAgICBvcHRpb25zOiBUQ29ubmVjdG9yUGFyYW1zXG4gICkge1xuICAgIHRoaXMud2lkZ2V0ID0gY29ubmVjdG9yKHRoaXMudXBkYXRlU3RhdGUsIG5vb3AgYXMgVW5tb3VudGVyKShvcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnBhcmVudC5hZGRXaWRnZXRzKFt0aGlzLndpZGdldF0pO1xuICB9XG5cbiAgcHVibGljIG5nT25EZXN0cm95KCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLmluc3RhbnRTZWFyY2hJbnN0YW5jZS5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlV2lkZ2V0cyhbdGhpcy53aWRnZXRdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlU3RhdGU6IFJlbmRlcmVyPFxuICAgIFRXaWRnZXREZXNjcmlwdGlvblsncmVuZGVyU3RhdGUnXSxcbiAgICBUQ29ubmVjdG9yUGFyYW1zXG4gID4gPSAoc3RhdGUsIGlzRmlyc3RSZW5kZXJpbmcpID0+IHtcbiAgICBpZiAoaXNGaXJzdFJlbmRlcmluZykge1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBIZWxwZXIgdG8gZ2VuZXJhdGUgY2xhc3MgbmFtZXMgZm9yIGFuIGl0ZW1cbiAgICogQHBhcmFtIGl0ZW0gZWxlbWVudCB0byBnZW5lcmF0ZSBhIGNsYXNzIG5hbWUgZm9yXG4gICAqL1xuICBwdWJsaWMgZ2V0SXRlbUNsYXNzKGl0ZW06IHsgaXNSZWZpbmVkPzogYm9vbGVhbiB9KTogc3RyaW5nIHtcbiAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLmN4KCdpdGVtJyk7XG5cbiAgICBpZiAoaXRlbS5pc1JlZmluZWQpIHtcbiAgICAgIHJldHVybiBgJHtjbGFzc05hbWV9ICR7dGhpcy5jeCgnaXRlbScsICdzZWxlY3RlZCcpfWA7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsYXNzTmFtZTtcbiAgfVxufVxuIl19
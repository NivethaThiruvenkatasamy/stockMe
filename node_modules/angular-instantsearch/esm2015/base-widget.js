import { Input } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import { bem, noop } from './utils';
export class BaseWidget {
    constructor(widgetName) {
        this.state = {};
        this.updateState = (state, isFirstRendering) => {
            if (isFirstRendering) {
                return Promise.resolve().then(() => {
                    this.state = state;
                });
            }
            this.state = state;
        };
        this.cx = bem(widgetName);
    }
    get parent() {
        if (this.parentIndex) {
            return this.parentIndex;
        }
        return this.instantSearchInstance;
    }
    createWidget(connector, options = {}) {
        this.widget = connector(this.updateState, noop)(options);
    }
    ngOnInit() {
        this.parent.addWidgets([this.widget]);
    }
    ngOnDestroy() {
        if (isPlatformBrowser(this.instantSearchInstance.platformId)) {
            this.parent.removeWidgets([this.widget]);
        }
    }
    /**
     * Helper to generate class names for an item
     * @param item element to generate a class name for
     */
    getItemClass(item) {
        const className = this.cx('item');
        if (item.isRefined) {
            return `${className} ${this.cx('item', 'selected')}`;
        }
        return className;
    }
}
BaseWidget.propDecorators = {
    autoHideContainer: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS13aWRnZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYmFzZS13aWRnZXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBaUMsTUFBTSxlQUFlLENBQUM7QUFDckUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEQsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFnQnBDLE1BQU0sT0FBZ0IsVUFBVTtJQVU5QixZQUFZLFVBQWtCO1FBTHZCLFVBQUssR0FBWSxFQUFZLENBQUM7UUE4QjlCLGdCQUFXLEdBQUcsQ0FDbkIsS0FBYSxFQUNiLGdCQUF5QixFQUNILEVBQUU7WUFDeEIsSUFBSSxnQkFBZ0IsRUFBRTtnQkFDcEIsT0FBTyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtvQkFDakMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7Z0JBQ3JCLENBQUMsQ0FBQyxDQUFDO2FBQ0o7WUFFRCxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNyQixDQUFDLENBQUM7UUFuQ0EsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVELElBQUksTUFBTTtRQUNSLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNwQixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7U0FDekI7UUFDRCxPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQztJQUNwQyxDQUFDO0lBRU0sWUFBWSxDQUFDLFNBQW9CLEVBQUUsVUFBa0IsRUFBRTtRQUM1RCxJQUFJLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFFTSxRQUFRO1FBQ2IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRU0sV0FBVztRQUNoQixJQUFJLGlCQUFpQixDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUM1RCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1NBQzFDO0lBQ0gsQ0FBQztJQWVEOzs7T0FHRztJQUNJLFlBQVksQ0FBQyxJQUE2QjtRQUMvQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRWxDLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNsQixPQUFPLEdBQUcsU0FBUyxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUM7U0FDdEQ7UUFFRCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDOzs7Z0NBMURBLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnB1dCwgT25EZXN0cm95LCBPbkluaXQsIGZvcndhcmRSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IGJlbSwgbm9vcCB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgTmdBaXNJbnN0YW50U2VhcmNoIH0gZnJvbSAnLi9pbnN0YW50c2VhcmNoL2luc3RhbnRzZWFyY2gnO1xuaW1wb3J0IHsgTmdBaXNJbmRleCB9IGZyb20gJy4vaW5kZXgtd2lkZ2V0L2luZGV4LXdpZGdldCc7XG5pbXBvcnQgeyBXaWRnZXQgYXMgVyB9IGZyb20gJ2luc3RhbnRzZWFyY2guanMvZXMvdHlwZXMnO1xuaW1wb3J0IHsgSW5kZXhXaWRnZXQgfSBmcm9tICdpbnN0YW50c2VhcmNoLmpzL2VzL3dpZGdldHMvaW5kZXgvaW5kZXgnO1xuXG5leHBvcnQgdHlwZSBXaWRnZXQgPSBXIHwgSW5kZXhXaWRnZXQ7XG5cbi8vIFRPRE86IHVzZSBDb25uZWN0b3IgdHlwZSBmcm9tIEluc3RhbnRTZWFyY2guIE5vdCB5ZXQgcG9zc2libGUgbm93LFxuLy8gc2luY2Ugbm9uLXRzIGNvbm5lY3RvcnMgY2FuJ3QgaGF2ZSBnZW5lcmljcyBsaWtlIENvbm5lY3RvciBoYXMsXG4vLyBhcyB3ZWxsIGFzIHNvbWV0aW1lcyBiZWluZyBub3QgYWNjdXJhdGUgZW5vdWdoIC8gbWlzc2luZyBrZXlzLlxuZXhwb3J0IHR5cGUgQ29ubmVjdG9yID0gKFxuICByZW5kZXJGbjogKHN0YXRlOiBvYmplY3QsIGlzRmlyc3RSZW5kZXJpbmc6IGJvb2xlYW4pID0+IHZvaWQsXG4gIHVubW91bnRGbjogKCkgPT4gdm9pZFxuKSA9PiAod2lkZ2V0T3B0aW9ucz86IG9iamVjdCkgPT4gV2lkZ2V0O1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZVdpZGdldDxUU3RhdGUgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9PlxuICBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KCkgcHVibGljIGF1dG9IaWRlQ29udGFpbmVyPzogYm9vbGVhbjtcblxuICBwdWJsaWMgd2lkZ2V0PzogV2lkZ2V0O1xuICBwdWJsaWMgc3RhdGU/OiBUU3RhdGUgPSB7fSBhcyBUU3RhdGU7XG4gIHB1YmxpYyBjeDogUmV0dXJuVHlwZTx0eXBlb2YgYmVtPjtcbiAgcHVibGljIGFic3RyYWN0IGluc3RhbnRTZWFyY2hJbnN0YW5jZTogTmdBaXNJbnN0YW50U2VhcmNoO1xuICBwdWJsaWMgYWJzdHJhY3QgcGFyZW50SW5kZXg/OiBOZ0Fpc0luZGV4O1xuXG4gIGNvbnN0cnVjdG9yKHdpZGdldE5hbWU6IHN0cmluZykge1xuICAgIHRoaXMuY3ggPSBiZW0od2lkZ2V0TmFtZSk7XG4gIH1cblxuICBnZXQgcGFyZW50KCkge1xuICAgIGlmICh0aGlzLnBhcmVudEluZGV4KSB7XG4gICAgICByZXR1cm4gdGhpcy5wYXJlbnRJbmRleDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZVdpZGdldChjb25uZWN0b3I6IENvbm5lY3Rvciwgb3B0aW9uczogb2JqZWN0ID0ge30pIHtcbiAgICB0aGlzLndpZGdldCA9IGNvbm5lY3Rvcih0aGlzLnVwZGF0ZVN0YXRlLCBub29wKShvcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnBhcmVudC5hZGRXaWRnZXRzKFt0aGlzLndpZGdldF0pO1xuICB9XG5cbiAgcHVibGljIG5nT25EZXN0cm95KCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLmluc3RhbnRTZWFyY2hJbnN0YW5jZS5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlV2lkZ2V0cyhbdGhpcy53aWRnZXRdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlU3RhdGUgPSAoXG4gICAgc3RhdGU6IFRTdGF0ZSxcbiAgICBpc0ZpcnN0UmVuZGVyaW5nOiBib29sZWFuXG4gICk6IFByb21pc2U8dm9pZD4gfCB2b2lkID0+IHtcbiAgICBpZiAoaXNGaXJzdFJlbmRlcmluZykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhlbHBlciB0byBnZW5lcmF0ZSBjbGFzcyBuYW1lcyBmb3IgYW4gaXRlbVxuICAgKiBAcGFyYW0gaXRlbSBlbGVtZW50IHRvIGdlbmVyYXRlIGEgY2xhc3MgbmFtZSBmb3JcbiAgICovXG4gIHB1YmxpYyBnZXRJdGVtQ2xhc3MoaXRlbTogeyBpc1JlZmluZWQ/OiBib29sZWFuIH0pIHtcbiAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLmN4KCdpdGVtJyk7XG5cbiAgICBpZiAoaXRlbS5pc1JlZmluZWQpIHtcbiAgICAgIHJldHVybiBgJHtjbGFzc05hbWV9ICR7dGhpcy5jeCgnaXRlbScsICdzZWxlY3RlZCcpfWA7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsYXNzTmFtZTtcbiAgfVxufVxuIl19